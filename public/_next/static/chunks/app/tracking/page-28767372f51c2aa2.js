(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{84026:(e,t,a)=>{Promise.resolve().then(a.bind(a,55221))},55221:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var s=a(95155),r=a(12115),l=a(76046),i=a(34696),n=a(46803),o=a(73110),d=a(13901),c=a(41738),u=a(82800);let x=(0,u.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var m=a(60719);let p=(0,u.A)("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]);var h=a(50878),g=a(57223),y=a(20853);let f=(0,u.A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var b=a(38684),v=a(28880),j=a(45686);let N=(0,u.A)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var k=a(14081);let w=(0,u.A)("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);var A=a(40767);function C(){var e,t,a,u,C,D,S;let L=(0,l.useRouter)(),{isAuthenticated:I,user:_,loading:M}=(0,i.A)(),{showError:P,showSuccess:T}=(0,n.h)(),[F,U]=(0,r.useState)(!0),[H,E]=(0,r.useState)([]),[z,O]=(0,r.useState)([]),[q,B]=(0,r.useState)(""),[R,V]=(0,r.useState)("all"),[G,W]=(0,r.useState)("all"),[Z,K]=(0,r.useState)(null),[J,Q]=(0,r.useState)({}),[X,Y]=(0,r.useState)({}),[$,ee]=(0,r.useState)(null),[et,ea]=(0,r.useState)(!1),[es,er]=(0,r.useState)(!1),[el,ei]=(0,r.useState)([]),[en,eo]=(0,r.useState)(!1),[ed,ec]=(0,r.useState)(!1),[eu,ex]=(0,r.useState)(null),em=(0,r.useCallback)(async()=>{try{U(!0);let[e,t,a,s]=await Promise.all([d.wH.getAll(),d.TB.getAll(),d.xg.getAll(),d.wH.getProof("").catch(()=>({data:[]}))]);console.log("Fetched tracking data:",e.data.tracking);let r=t.data.data||t.data.donations||[],l={};r.forEach(e=>{l[e.id]=e}),Q(l);let i=a.data.data||a.data.calamities||[],n={};i.forEach(e=>{n[e.id]=e}),Y(n);let o=e.data.tracking||[],c=s.data||[];o=o.map(e=>({...e,proofOfDistribution:c.filter(t=>t.trackingId===e.id)})),E(o)}catch(e){console.error("Error fetching tracking data:",e),P("Failed to fetch tracking data")}finally{U(!1)}},[P,_]),ep=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{let s=H.find(t=>t.id===e);if(!s){P("Tracking record not found");return}let r={status:t,location:a||eh(t),timestamp:new Date().toISOString(),notes:"Status updated to ".concat(t.replace("_"," "))},l=[...s.statusHistory||[],r];await d.wH.updateStatus(e,{...s,status:t,currentLocation:r.location,statusHistory:l,updatedAt:new Date().toISOString()}),T("Tracking status updated successfully");try{let a=J[s.donationId];a&&a.donorId&&await d.i9.create({message:"Your donation #".concat(s.donationId," status updated to: ").concat(t.replace("_"," ").toUpperCase()),type:"tracking",userId:a.donorId,donationId:s.donationId,trackingId:e})}catch(e){console.error("Failed to create tracking notification:",e)}em()}catch(e){console.error("Error updating tracking status:",e),P("Failed to update tracking status")}},eh=e=>{switch(e){case"processing":return"Processing Center";case"in_transit":return"In Transit";case"out_for_delivery":return"Out for Delivery";case"delivered":return"Delivered to Recipient";default:return"Unknown Location"}},eg=e=>{switch(null==e?void 0:e.toLowerCase()){case"pending":return"processing";case"processing":return"in_transit";case"in_transit":return"out_for_delivery";case"out_for_delivery":return"delivered";default:return null}},ey=e=>{let t=eg(e);return t?t.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()):null},ef=async e=>{if(confirm("Are you sure you want to delete this tracking record?"))try{await d.wH.delete(e),T("Tracking record deleted successfully"),em()}catch(e){console.error("Error deleting tracking:",e),P("Failed to delete tracking record")}},eb=e=>{ee({id:e.id,trackingNumber:e.trackingNumber||"",status:e.status||"pending",currentLocation:e.currentLocation||"",estimatedDelivery:e.estimatedDelivery||""}),ea(!0)},ev=async e=>{e.preventDefault();try{await d.wH.updateStatus($.id,{trackingNumber:$.trackingNumber,status:$.status,currentLocation:$.currentLocation,estimatedDelivery:$.estimatedDelivery,updatedAt:new Date().toISOString()}),T("Tracking record updated successfully"),ea(!1),ee(null),em()}catch(e){console.error("Error updating tracking:",e),P("Failed to update tracking record")}};(0,r.useEffect)(()=>{if(!M&&!I()){L.push("/login");return}if(I()){em(),(0,c.cH)();let e=(0,c.L2)(e=>{console.log("Tracking update received:",e),em()});return()=>{e&&e()}}},[M,I,L,em]),(0,r.useEffect)(()=>{q||"all"!==R||"all"!==G?O(H.filter(e=>{var t,a,s;let r=J[e.donationId],l=!q||(null===(t=e.trackingNumber)||void 0===t?void 0:t.toLowerCase().includes(q.toLowerCase()))||(null===(a=e.status)||void 0===a?void 0:a.toLowerCase().includes(q.toLowerCase()))||(null==r?void 0:null===(s=r.donorName)||void 0===s?void 0:s.toLowerCase().includes(q.toLowerCase())),i="all"===R||(null==r?void 0:r.calamityId)===R,n="all"===G||(null==r?void 0:r.type)===G;return l&&i&&n})):O(H)},[H,q,R,G,J]);let ej=e=>e&&e.donorName?(null==_?void 0:_.role)==="admin"||(null==_?void 0:_.role)==="relief_worker"||(null==_?void 0:_.role)==="volunteer"||(null==_?void 0:_.role)==="donor"&&e.donorId===_.id?e.donorName:"Anonymous":null,eN=e=>{ei(t=>t.filter((t,a)=>a!==e))},ek=async()=>{if(!Z||0===el.length){P("Please select files to upload");return}try{eo(!0);let e=[];for(let t of el)try{let a=null;t.type.startsWith("image/")&&(a=await new Promise((e,a)=>{let s=new FileReader;s.onload=()=>e(s.result),s.onerror=a,s.readAsDataURL(t.file)}));let s=new FormData;s.append("file",t.file),s.append("fileName",t.name),s.append("fileType",t.type),s.append("trackingId",Z.id),s.append("uploadedBy",(null==_?void 0:_.name)||"Unknown"),s.append("uploadedById",null==_?void 0:_.id),s.append("uploadedAt",new Date().toISOString()),a&&s.append("fileData",a);let r=await d.wH.uploadProof(Z.id,s);console.log("Upload response:",r),e.push({fileName:t.name,fileType:t.type,uploadedBy:(null==_?void 0:_.name)||"Unknown",uploadedById:null==_?void 0:_.id,uploadedAt:new Date().toISOString(),trackingId:Z.id,fileData:a})}catch(e){throw console.error("Error uploading file:",t.name,e),Error("Failed to upload ".concat(t.name,": ").concat(e.message))}T("Proof of distribution uploaded successfully"),ei([]),er(!1),K({...Z,proofOfDistribution:[...Z.proofOfDistribution||[],...e]}),setTimeout(()=>{em()},500)}catch(a){var e,t;console.error("Error uploading proof:",a),P("Failed to upload proof: "+((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||a.message||"Unknown error occurred"))}finally{eo(!1)}},ew=e=>{switch(null==e?void 0:e.toLowerCase()){case"pending":return(0,s.jsx)(x,{className:"w-5 h-5 text-yellow-500"});case"processing":return(0,s.jsx)(m.A,{className:"w-5 h-5 text-blue-500"});case"in_transit":case"out_for_delivery":return(0,s.jsx)(p,{className:"w-5 h-5 text-purple-500"});case"delivered":return(0,s.jsx)(h.A,{className:"w-5 h-5 text-green-500"});default:return(0,s.jsx)(g.A,{className:"w-5 h-5 text-gray-500"})}},eA=e=>{switch(null==e?void 0:e.toLowerCase()){case"pending":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"processing":return"bg-blue-100 text-blue-700 border-blue-200";case"in_transit":case"out_for_delivery":return"bg-purple-100 text-purple-700 border-purple-200";case"delivered":return"bg-green-100 text-green-700 border-green-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},eC=e=>{switch(null==e?void 0:e.toLowerCase()){case"pending":default:return 0;case"processing":return 25;case"in_transit":return 50;case"out_for_delivery":return 75;case"delivered":return 100}};return M||F?(0,s.jsx)(o.A,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):(0,s.jsx)(o.A,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Tracking & Logistics"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Real-time tracking of donation deliveries"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(y.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,s.jsx)("input",{type:"text",placeholder:"Search by tracking number or donor name...",value:q,onChange:e=>B(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Calamity"}),(0,s.jsxs)("select",{value:R,onChange:e=>V(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"all",children:"All Calamities"}),Object.entries(X).map(e=>{let[t,a]=e;return(0,s.jsx)("option",{value:t,children:a.name||a.title||"Unknown Calamity"},t)})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Donation Type"}),(0,s.jsxs)("select",{value:G,onChange:e=>W(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"all",children:"All Types"}),(0,s.jsx)("option",{value:"monetary",children:"Monetary"}),(0,s.jsx)("option",{value:"in-kind",children:"In-Kind"})]})]})]}),("all"!==R||"all"!==G)&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:["all"!==R&&(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:["Calamity: ",(null===(e=X[R])||void 0===e?void 0:e.name)||"Unknown",(0,s.jsx)("button",{onClick:()=>V("all"),className:"ml-1 text-blue-500 hover:text-blue-800",children:"\xd7"})]}),"all"!==G&&(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm",children:["Type: ","monetary"===G?"Monetary":"In-Kind",(0,s.jsx)("button",{onClick:()=>W("all"),className:"ml-1 text-green-500 hover:text-green-800",children:"\xd7"})]})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:z.length>0?z.map(e=>{var t,a,r,l,i,n;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>K(e),children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:e.trackingNumber?"Tracking #".concat(e.trackingNumber):"Donation Delivery"}),J[e.donationId]&&(0,s.jsxs)(s.Fragment,{children:[ej(J[e.donationId])&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["From: ",(0,s.jsx)("span",{className:"font-medium",children:ej(J[e.donationId])})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"monetary"===J[e.donationId].type?"₱".concat((null===(t=J[e.donationId].amount)||void 0===t?void 0:t.toLocaleString())||0):"".concat(J[e.donationId].itemName||"Item"," (").concat(J[e.donationId].quantity||0,")")})]}),(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Reference: ",e.donationId]})]}),(0,s.jsx)("span",{className:"px-3 py-1 text-xs font-medium rounded-full border ".concat(eA(e.status)),children:null===(a=e.status)||void 0===a?void 0:a.replace("_"," ").toUpperCase()})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-2",children:[(0,s.jsx)("span",{children:"Progress"}),(0,s.jsxs)("span",{children:[eC(e.status),"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(eC(e.status),"%")}})})]}),(0,s.jsx)("div",{className:"space-y-3",children:null===(r=e.statusHistory)||void 0===r?void 0:r.slice(0,3).map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 mt-1",children:ew(e.status)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-800 capitalize",children:null===(a=e.status)||void 0===a?void 0:a.replace("_"," ")}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:e.location||"No location"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.timestamp).toLocaleString()})]})]},t)})}),e.currentLocation&&(0,s.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,s.jsx)(g.A,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:["Current Location: ",e.currentLocation]})]})}),e.estimatedDelivery&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,s.jsx)("span",{className:"font-medium",children:"Est. Delivery:"})," ",new Date(e.estimatedDelivery).toLocaleDateString()]})}),((null==_?void 0:_.role)==="admin"||(null==_?void 0:_.role)==="relief_worker")&&(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 space-y-2",children:[(null===(l=e.status)||void 0===l?void 0:l.toLowerCase())!=="delivered"&&eg(e.status)&&(0,s.jsxs)("button",{onClick:t=>{t.stopPropagation(),ep(e.id,eg(e.status))},className:"w-full flex items-center justify-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[(0,s.jsxs)("span",{children:["Update to ",ey(e.status)]}),(0,s.jsx)(f,{className:"w-4 h-4"})]}),(null===(i=e.status)||void 0===i?void 0:i.toLowerCase())==="out_for_delivery"||(null===(n=e.status)||void 0===n?void 0:n.toLowerCase())==="delivered"?(0,s.jsxs)("button",{onClick:t=>{t.stopPropagation(),K(e),er(!0)},className:"w-full flex items-center justify-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:[(0,s.jsx)(b.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Upload Proof"})]}):null,(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:t=>{t.stopPropagation(),eb(e)},className:"flex-1 flex items-center justify-center gap-2 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors",children:[(0,s.jsx)(v.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Edit"})]}),(0,s.jsxs)("button",{onClick:t=>{t.stopPropagation(),ef(e.id)},className:"flex-1 flex items-center justify-center gap-2 bg-red-100 text-red-700 px-4 py-2 rounded-lg hover:bg-red-200 transition-colors",children:[(0,s.jsx)(j.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Delete"})]})]})]})]},e.id)}):(0,s.jsxs)("div",{className:"col-span-2 text-center py-12",children:[(0,s.jsx)(m.A,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No Tracking Data Available"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"Tracking records are automatically created when donations are verified or delivered."}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Go to the Donations page and verify a donation to create tracking data."})]})}),Z&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>K(null),children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Delivery Tracking"}),(0,s.jsxs)("p",{className:"text-gray-600 mt-1",children:["Tracking Number: ",(0,s.jsx)("span",{className:"font-semibold font-mono",children:Z.trackingNumber||"N/A"})]}),J[Z.donationId]&&(0,s.jsxs)(s.Fragment,{children:[ej(J[Z.donationId])&&(0,s.jsxs)("p",{className:"text-gray-600 mt-1",children:["From: ",(0,s.jsx)("span",{className:"font-semibold",children:ej(J[Z.donationId])})]}),(0,s.jsx)("p",{className:"text-gray-600",children:"monetary"===J[Z.donationId].type?"Amount: ₱".concat((null===(t=J[Z.donationId].amount)||void 0===t?void 0:t.toLocaleString())||0):"Item: ".concat(J[Z.donationId].itemName||"N/A"," (Qty: ").concat(J[Z.donationId].quantity||0,")")})]})]}),(0,s.jsx)("button",{onClick:()=>K(null),className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)("span",{className:"text-2xl",children:"\xd7"})})]}),(0,s.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,s.jsx)("p",{className:"text-xs text-blue-600 font-semibold uppercase tracking-wide mb-1",children:"Tracking Number"}),(0,s.jsx)("p",{className:"text-2xl font-mono font-bold text-blue-900",children:Z.trackingNumber||"N/A"}),(0,s.jsx)("p",{className:"text-xs text-blue-600 mt-2",children:"Use this number to track your donation delivery"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Status History"}),null===(a=Z.statusHistory)||void 0===a?void 0:a.map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"flex items-start gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex-shrink-0 mt-1",children:ew(e.status)}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-gray-800 capitalize",children:null===(a=e.status)||void 0===a?void 0:a.replace("_"," ")}),e.location&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[(0,s.jsx)(g.A,{className:"w-3 h-3 inline mr-1"}),e.location]}),e.notes&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.notes}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:new Date(e.timestamp).toLocaleString()})]})]},t)})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Route Map"}),(0,s.jsx)("div",{className:"bg-gray-100 rounded-lg h-64 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center text-gray-500",children:[(0,s.jsx)(g.A,{className:"w-12 h-12 mx-auto mb-2"}),(0,s.jsx)("p",{children:"Map integration placeholder"}),(0,s.jsx)("p",{className:"text-sm",children:"Google Maps API can be integrated here"})]})})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Proof of Distribution"}),((null==_?void 0:_.role)==="admin"||(null==_?void 0:_.role)==="relief_worker")&&((null===(u=Z.status)||void 0===u?void 0:u.toLowerCase())==="out_for_delivery"||(null===(C=Z.status)||void 0===C?void 0:C.toLowerCase())==="delivered")&&(0,s.jsxs)("button",{onClick:()=>er(!0),className:"flex items-center gap-1 px-3 py-1 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors",children:[(0,s.jsx)(b.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Add Proof"})]})]}),Z.proofOfDistribution&&Z.proofOfDistribution.length>0?(0,s.jsx)("div",{className:"space-y-3",children:Z.proofOfDistribution.map((e,t)=>{var a,r;return(0,s.jsx)("div",{className:"overflow-hidden bg-gray-50 rounded-lg border border-gray-200",children:(null===(a=e.fileType)||void 0===a?void 0:a.startsWith("image/"))&&e.fileData?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{src:e.fileData,alt:e.fileName,className:"w-full h-48 object-cover cursor-pointer hover:opacity-75 transition-opacity",onClick:()=>{ex({src:e.fileData,fileName:e.fileName,uploadedBy:e.uploadedBy,uploadedAt:e.uploadedAt}),ec(!0)}}),(0,s.jsxs)("div",{className:"p-4 border-t border-gray-200",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-800 truncate",children:e.fileName}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Uploaded by ",e.uploadedBy," on ",new Date(e.uploadedAt).toLocaleString()]})]})]}):(0,s.jsxs)("div",{className:"p-4 flex items-start gap-3",children:[(null===(r=e.fileType)||void 0===r?void 0:r.startsWith("image/"))?(0,s.jsx)(N,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-1"}):"application/pdf"===e.fileType?(0,s.jsx)(k.A,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-1"}):(0,s.jsx)(w,{className:"w-5 h-5 text-gray-500 flex-shrink-0 mt-1"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-800 truncate",children:e.fileName}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Uploaded by ",e.uploadedBy," on ",new Date(e.uploadedAt).toLocaleString()]})]})]})},t)})}):(0,s.jsxs)("div",{className:"p-6 bg-gray-50 rounded-lg border border-gray-200 text-center",children:[(0,s.jsx)(k.A,{className:"w-12 h-12 mx-auto text-gray-300 mb-2"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"No proof of distribution uploaded yet"}),((null==_?void 0:_.role)==="admin"||(null==_?void 0:_.role)==="relief_worker")&&((null===(D=Z.status)||void 0===D?void 0:D.toLowerCase())==="out_for_delivery"||(null===(S=Z.status)||void 0===S?void 0:S.toLowerCase())==="delivered")&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Upload photos, signatures, or documents to prove distribution"})]})]})]})}),et&&$&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>ea(!1),children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Edit Tracking Record"}),(0,s.jsxs)("form",{onSubmit:ev,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tracking Number"}),(0,s.jsx)("input",{type:"text",value:$.trackingNumber,onChange:e=>ee({...$,trackingNumber:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter tracking number"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{value:$.status,onChange:e=>ee({...$,status:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"pending",children:"Pending"}),(0,s.jsx)("option",{value:"processing",children:"Processing"}),(0,s.jsx)("option",{value:"in_transit",children:"In Transit"}),(0,s.jsx)("option",{value:"out_for_delivery",children:"Out for Delivery"}),(0,s.jsx)("option",{value:"delivered",children:"Delivered"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Location"}),(0,s.jsx)("input",{type:"text",value:$.currentLocation,onChange:e=>ee({...$,currentLocation:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter current location"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estimated Delivery"}),(0,s.jsx)("input",{type:"date",value:$.estimatedDelivery,onChange:e=>ee({...$,estimatedDelivery:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{ea(!1),ee(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Save Changes"})]})]})]})}),es&&Z&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>{er(!1),ei([])},children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Upload Proof of Distribution"}),(0,s.jsxs)("p",{className:"text-gray-600 mt-1",children:["For Tracking: ",(0,s.jsx)("span",{className:"font-semibold font-mono",children:Z.trackingNumber||"N/A"})]})]}),(0,s.jsx)("button",{onClick:()=>{er(!1),ei([])},className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)("span",{className:"text-2xl",children:"\xd7"})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,s.jsx)("p",{className:"text-sm text-blue-900 font-medium mb-2",children:"Accepted formats:"}),(0,s.jsxs)("ul",{className:"text-xs text-blue-800 space-y-1",children:[(0,s.jsx)("li",{children:"• Photos: JPG, PNG, GIF (max 10MB each)"}),(0,s.jsx)("li",{children:"• Documents: PDF (max 10MB each)"}),(0,s.jsx)("li",{children:"• Signatures: Any image format"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Files to Upload"}),(0,s.jsx)("input",{type:"file",multiple:!0,accept:"image/*,.pdf",onChange:e=>{Array.from(e.target.files).forEach(e=>{if(e.size>0xa00000){P('File "'.concat(e.name,'" is too large. Maximum size is 10MB.'));return}if(!["image/jpeg","image/png","image/gif","image/webp","application/pdf"].includes(e.type)){P('File "'.concat(e.name,'" has invalid format. Only images and PDFs are allowed.'));return}ei(t=>[...t,{file:e,name:e.name,type:e.type,size:e.size}])})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),el.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Selected Files (",el.length,")"]}),(0,s.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:el.map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(null===(a=e.type)||void 0===a?void 0:a.startsWith("image/"))?(0,s.jsx)(N,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}):"application/pdf"===e.type?(0,s.jsx)(k.A,{className:"w-4 h-4 text-red-500 flex-shrink-0"}):(0,s.jsx)(w,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,s.jsx)("span",{className:"text-xs text-gray-700 truncate",children:e.name})]}),(0,s.jsx)("button",{type:"button",onClick:()=>eN(t),className:"ml-2 text-red-500 hover:text-red-700 flex-shrink-0",children:(0,s.jsx)(A.A,{className:"w-4 h-4"})})]},t)})})]}),(0,s.jsx)("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:(0,s.jsx)("p",{className:"text-xs text-green-800",children:"\uD83D\uDCA1 Tip: Upload clear photos of distribution, signatures from recipients, or official delivery documents for transparency."})}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{er(!1),ei([])},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:ek,disabled:0===el.length||en,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:en?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,s.jsx)("span",{children:"Uploading..."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.A,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:["Upload ",el.length>0?"(".concat(el.length,")"):""]})]})})]})]})]})}),ed&&eu&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4",onClick:()=>{ec(!1),ex(null)},children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-auto",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:eu.fileName}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Uploaded by ",eu.uploadedBy," on ",new Date(eu.uploadedAt).toLocaleString()]})]}),(0,s.jsx)("button",{onClick:()=>{ec(!1),ex(null)},className:"text-gray-400 hover:text-gray-600 text-2xl leading-none",children:"\xd7"})]}),(0,s.jsx)("div",{className:"p-4 flex items-center justify-center bg-gray-50",children:(0,s.jsx)("img",{src:eu.src,alt:eu.fileName,className:"max-w-full max-h-[calc(90vh-200px)] object-contain"})})]})})]})})}},73110:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(95155),r=a(12115),l=a(16062),i=a(85524);function n(e){let{children:t}=e,[a,n]=(0,r.useState)(!1);return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(l.A,{onMenuClick:()=>n(!a)}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(i.A,{isOpen:a,onClose:()=>n(!1)}),(0,s.jsx)("main",{className:"flex-1 p-6 lg:p-8 overflow-x-hidden",children:t})]})]})}},46803:(e,t,a)=>{"use strict";a.d(t,{NotificationProvider:()=>n,h:()=>i});var s=a(95155),r=a(12115);let l=(0,r.createContext)({}),i=()=>{let e=(0,r.useContext)(l);if(!e)throw Error("useNotification must be used within a NotificationProvider");return e},n=e=>{let{children:t}=e,[a,i]=(0,r.useState)([]),n=(0,r.useCallback)(e=>{let t=Date.now()+Math.random(),a={id:t,type:e.type||"info",message:e.message,duration:e.duration||5e3};return i(e=>[...e,a]),a.duration>0&&setTimeout(()=>{o(t)},a.duration),t},[]),o=(0,r.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]),d=(0,r.useCallback)((e,t)=>n({type:"success",message:e,duration:t}),[n]),c=(0,r.useCallback)((e,t)=>n({type:"error",message:e,duration:t}),[n]),u=(0,r.useCallback)((e,t)=>n({type:"warning",message:e,duration:t}),[n]),x=(0,r.useCallback)((e,t)=>n({type:"info",message:e,duration:t}),[n]),m=(0,r.useCallback)(()=>{i([])},[]);return(0,s.jsx)(l.Provider,{value:{notifications:a,addNotification:n,removeNotification:o,showSuccess:d,showError:c,showWarning:u,showInfo:x,clearAll:m},children:t})}},36972:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},35288:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},50878:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},14081:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},30858:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},65236:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},57223:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},86710:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},63348:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},60719:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},28880:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},20853:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},45686:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},38684:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},1466:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},92823:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},40767:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[568,422,696,465,441,517,358],()=>t(84026)),_N_E=e.O()}]);