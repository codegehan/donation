(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[257],{79191:(e,t,a)=>{Promise.resolve().then(a.bind(a,99669))},99669:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var s=a(95155),r=a(12115),l=a(76046),i=a(34696),n=a(46803),c=a(73110),d=a(13901),o=a(33473),x=a(36972),u=a(28880),h=a(57223),y=a(92823),m=a(32423),p=a(22079),g=a(60719);function f(){let e=(0,l.useRouter)(),{isAuthenticated:t,hasAnyRole:a,loading:f,user:b}=(0,i.A)(),{showSuccess:v,showError:j}=(0,n.h)(),[k,N]=(0,r.useState)(!0),[w,A]=(0,r.useState)([]),[C,M]=(0,r.useState)({}),[D,P]=(0,r.useState)(!1),[q,S]=(0,r.useState)(null),[E,L]=(0,r.useState)({name:"",type:"earthquake",location:"",description:"",severity:"moderate",status:"active",affectedPeople:"",startDate:""}),z=(0,r.useCallback)(async()=>{try{N(!0);let e=(await d.xg.getAll()).data.calamities||[];A(e);let t=await d.TB.getAll(),a=t.data.data||t.data.donations||[],s={};e.forEach(e=>{let t=a.filter(t=>t.calamityId===e.id),r=new Set(t.map(e=>e.donorId)),l=t.filter(e=>"monetary"===e.type),i=t.filter(e=>"in-kind"===e.type);s[e.id]={totalDonations:t.length,uniqueDonors:r.size,monetaryCount:l.length,goodsCount:i.length,totalAmount:l.reduce((e,t)=>e+(t.amount||0),0)}}),M(s)}catch(e){console.error("Error fetching calamities:",e),j("Failed to fetch calamities")}finally{N(!1)}},[j]);(0,r.useEffect)(()=>{if(!f&&!t()){e.push("/login");return}t()&&z()},[f,t,e,j,z]);let _=e=>{let{name:t,value:a}=e.target;L(e=>({...e,[t]:a}))},H=async e=>{e.preventDefault();try{let e={...E,affectedPeople:E.affectedPeople?parseInt(E.affectedPeople):null};q?(await d.xg.update(q.id,e),v("Calamity updated successfully")):(await d.xg.create(e),v("Calamity created successfully")),P(!1),S(null),L({name:"",type:"earthquake",location:"",description:"",severity:"moderate",status:"active",affectedPeople:"",startDate:""}),z()}catch(e){console.error("Error saving calamity:",e),j("Failed to save calamity")}},T=e=>{S(e),L({name:e.name||"",type:e.type||"earthquake",location:e.location||"",description:e.description||"",severity:e.severity||"moderate",status:e.status||"active",affectedPeople:e.affectedPeople||"",startDate:e.startDate?e.startDate.split("T")[0]:""}),P(!0)},F=e=>{switch(null==e?void 0:e.toLowerCase()){case"critical":return"bg-red-100 text-red-700 border-red-200";case"high":return"bg-orange-100 text-orange-700 border-orange-200";case"moderate":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"low":return"bg-green-100 text-green-700 border-green-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},O=e=>{switch(null==e?void 0:e.toLowerCase()){case"active":return"bg-green-100 text-green-700";case"resolved":return"bg-blue-100 text-blue-700";case"monitoring":return"bg-yellow-100 text-yellow-700";default:return"bg-gray-100 text-gray-700"}};return f||k?(0,s.jsx)(c.A,{children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):(0,s.jsx)(c.A,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Calamities"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:a(["admin","relief_worker"])?"Manage disaster events and relief operations":"View active calamities and donate to relief efforts"})]}),a(["admin","relief_worker"])&&(0,s.jsxs)("button",{onClick:()=>{S(null),L({name:"",type:"earthquake",location:"",description:"",severity:"moderate",status:"active",affectedPeople:"",startDate:""}),P(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[(0,s.jsx)(o.A,{className:"w-5 h-5"}),"New Calamity"]})]}),D&&a(["admin","relief_worker"])&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:q?"Edit Calamity":"New Calamity"}),(0,s.jsxs)("form",{onSubmit:H,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Calamity Name *"}),(0,s.jsx)("input",{type:"text",name:"name",value:E.name,onChange:_,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Typhoon Odette"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type *"}),(0,s.jsxs)("select",{name:"type",value:E.type,onChange:_,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"earthquake",children:"Earthquake"}),(0,s.jsx)("option",{value:"typhoon",children:"Typhoon"}),(0,s.jsx)("option",{value:"flood",children:"Flood"}),(0,s.jsx)("option",{value:"fire",children:"Fire"}),(0,s.jsx)("option",{value:"landslide",children:"Landslide"}),(0,s.jsx)("option",{value:"drought",children:"Drought"}),(0,s.jsx)("option",{value:"other",children:"Other"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Severity *"}),(0,s.jsxs)("select",{name:"severity",value:E.severity,onChange:_,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"low",children:"Low"}),(0,s.jsx)("option",{value:"moderate",children:"Moderate"}),(0,s.jsx)("option",{value:"high",children:"High"}),(0,s.jsx)("option",{value:"critical",children:"Critical"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location *"}),(0,s.jsx)("input",{type:"text",name:"location",value:E.location,onChange:_,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Cebu, Philippines"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{name:"status",value:E.status,onChange:_,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"active",children:"Active"}),(0,s.jsx)("option",{value:"monitoring",children:"Monitoring"}),(0,s.jsx)("option",{value:"resolved",children:"Resolved"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),(0,s.jsx)("input",{type:"date",name:"startDate",value:E.startDate,onChange:_,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Affected People (Estimated)"}),(0,s.jsx)("input",{type:"number",name:"affectedPeople",value:E.affectedPeople,onChange:_,min:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Number of affected people"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,s.jsx)("textarea",{name:"description",value:E.description,onChange:_,rows:"4",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Describe the calamity and its impact..."})]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,s.jsx)("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:q?"Update Calamity":"Create Calamity"}),(0,s.jsx)("button",{type:"button",onClick:()=>P(!1),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.length>0?w.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-lg transition-all duration-300 hover:border-blue-200",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsx)("div",{className:"p-3 rounded-lg ".concat("critical"===e.severity?"bg-red-100":"high"===e.severity?"bg-orange-100":"bg-yellow-100"),children:(0,s.jsx)(x.A,{className:"w-6 h-6 ".concat("critical"===e.severity?"text-red-600":"high"===e.severity?"text-orange-600":"text-yellow-600")})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-lg text-gray-800",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-gray-500 capitalize mt-0.5",children:e.type})]})]}),a(["admin","relief_worker"])&&(0,s.jsx)("div",{className:"flex gap-2 ml-4",children:(0,s.jsx)("button",{onClick:()=>T(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit calamity",children:(0,s.jsx)(u.A,{className:"w-4 h-4"})})})]}),(0,s.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,s.jsx)(h.A,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),(0,s.jsx)("span",{className:"font-medium",children:e.location})]}),e.affectedPeople&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,s.jsx)(y.A,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"font-medium",children:e.affectedPeople.toLocaleString()}),(0,s.jsx)("span",{className:"text-gray-600",children:" people affected"})]})]}),e.startDate&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,s.jsx)(m.A,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),(0,s.jsx)("span",{children:new Date(e.startDate).toLocaleDateString()})]}),C[e.id]&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-700 pt-2 border-t border-gray-100",children:(0,s.jsxs)("div",{className:"text-xs font-medium text-gray-600",children:[(0,s.jsx)("span",{className:"text-blue-600 font-semibold",children:C[e.id].uniqueDonors}),(0,s.jsxs)("span",{className:"text-gray-600",children:[" donor",1!==C[e.id].uniqueDonors?"s":""]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[(0,s.jsx)(p.A,{className:"w-3 h-3 text-green-500"}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"font-semibold text-green-600",children:C[e.id].monetaryCount})," monetary"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[(0,s.jsx)(g.A,{className:"w-3 h-3 text-orange-500"}),(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"font-semibold text-orange-600",children:C[e.id].goodsCount})," goods"]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-4 border-t border-gray-100",children:[(0,s.jsxs)("span",{className:"px-3 py-1 text-xs font-semibold rounded-full border ".concat(F(e.severity)),children:[e.severity.charAt(0).toUpperCase()+e.severity.slice(1)," Severity"]}),(0,s.jsx)("span",{className:"px-3 py-1 text-xs font-semibold rounded-full ".concat(O(e.status)),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),e.description&&(0,s.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2 pt-3 mt-3 border-t border-gray-100",children:e.description})]},e.id)):(0,s.jsxs)("div",{className:"col-span-full text-center py-12 text-gray-500",children:[(0,s.jsx)(x.A,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),(0,s.jsx)("p",{children:"No calamities found"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"Create a new calamity to get started"})]})})]})})}},73110:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(95155),r=a(12115),l=a(16062),i=a(85524);function n(e){let{children:t}=e,[a,n]=(0,r.useState)(!1);return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(l.A,{onMenuClick:()=>n(!a)}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(i.A,{isOpen:a,onClose:()=>n(!1)}),(0,s.jsx)("main",{className:"flex-1 p-6 lg:p-8 overflow-x-hidden",children:t})]})]})}},46803:(e,t,a)=>{"use strict";a.d(t,{NotificationProvider:()=>n,h:()=>i});var s=a(95155),r=a(12115);let l=(0,r.createContext)({}),i=()=>{let e=(0,r.useContext)(l);if(!e)throw Error("useNotification must be used within a NotificationProvider");return e},n=e=>{let{children:t}=e,[a,i]=(0,r.useState)([]),n=(0,r.useCallback)(e=>{let t=Date.now()+Math.random(),a={id:t,type:e.type||"info",message:e.message,duration:e.duration||5e3};return i(e=>[...e,a]),a.duration>0&&setTimeout(()=>{c(t)},a.duration),t},[]),c=(0,r.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]),d=(0,r.useCallback)((e,t)=>n({type:"success",message:e,duration:t}),[n]),o=(0,r.useCallback)((e,t)=>n({type:"error",message:e,duration:t}),[n]),x=(0,r.useCallback)((e,t)=>n({type:"warning",message:e,duration:t}),[n]),u=(0,r.useCallback)((e,t)=>n({type:"info",message:e,duration:t}),[n]),h=(0,r.useCallback)(()=>{i([])},[]);return(0,s.jsx)(l.Provider,{value:{notifications:a,addNotification:n,removeNotification:c,showSuccess:d,showError:o,showWarning:x,showInfo:u,clearAll:h},children:t})}},36972:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},22079:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]])},35288:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},32423:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},14081:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},30858:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},65236:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},57223:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},86710:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},63348:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},60719:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},28880:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},33473:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1466:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},92823:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},40767:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(82800).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[568,422,696,465,441,517,358],()=>t(79191)),_N_E=e.O()}]);