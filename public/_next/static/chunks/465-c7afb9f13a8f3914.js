"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{16062:(e,r,t)=>{t.d(r,{A:()=>x});var s=t(95155),a=t(34696),l=t(86710),n=t(35288),i=t(1466),o=t(65236),c=t(12115),d=t(13901),m=t(41738);function x(e){let{onMenuClick:r}=e,{user:t,logout:x}=(0,a.A)(),[h,u]=(0,c.useState)(!1),[g,f]=(0,c.useState)(!1),[b,v]=(0,c.useState)([]),[j,p]=(0,c.useState)(0),N=(0,c.useRef)(null),w=(0,c.useRef)(null);(0,c.useEffect)(()=>{let e=async()=>{try{let e=((await d.i9.getAll()).data.notifications||[]).sort((e,r)=>{let t=new Date(e.createdAt||0);return new Date(r.createdAt||0)-t});v(e);let r=e.filter(e=>!e.read).length;p(r)}catch(e){console.error("Error fetching notifications (using fallback):",e),v([]),p(0)}};if(t){e();try{let e=(0,m._J)(e=>{v(r=>[e,...r]),e.read||p(e=>e+1)});return()=>{e&&e()}}catch(e){console.error("Socket connection optional:",e)}}},[t]);let y=async e=>{try{await d.i9.markAsRead(e),v(r=>r.map(r=>r.id===e?{...r,read:!0}:r)),p(e=>Math.max(0,e-1))}catch(e){console.error("Error marking notification as read:",e)}},k=async()=>{try{await d.i9.markAllAsRead(),v(e=>e.map(e=>({...e,read:!0}))),p(0)}catch(e){console.error("Error marking all as read:",e)}};return(0,c.useEffect)(()=>{let e=e=>{N.current&&!N.current.contains(e.target)&&f(!1),w.current&&!w.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.jsx)("nav",{className:"bg-white border-b border-gray-200 px-4 py-3 sticky top-0 z-50",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:r,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100",children:(0,s.jsx)(l.A,{className:"w-6 h-6 text-gray-600"})}),(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"Disaster Relief Management"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"relative",ref:N,children:[(0,s.jsxs)("button",{onClick:()=>f(!g),className:"relative p-2 rounded-lg hover:bg-gray-100",children:[(0,s.jsx)(n.A,{className:"w-6 h-6 text-gray-600"}),j>0&&(0,s.jsx)("span",{className:"absolute top-1 right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:j>9?"9+":j})]}),g&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 max-h-96 overflow-y-auto z-50",children:[(0,s.jsxs)("div",{className:"p-3 border-b border-gray-200 flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:"Notifications"}),j>0&&(0,s.jsx)("button",{onClick:k,className:"text-xs text-blue-600 hover:text-blue-700",children:"Mark all as read"})]}),(0,s.jsx)("div",{className:"divide-y divide-gray-100",children:0===b.length?(0,s.jsx)("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No notifications"}):b.slice(0,10).map(e=>(0,s.jsxs)("div",{onClick:()=>!e.read&&y(e.id),className:"p-3 hover:bg-gray-50 cursor-pointer ".concat(e.read?"":"bg-blue-50"),children:[(0,s.jsx)("p",{className:"text-sm text-gray-800",children:e.message}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.createdAt).toLocaleString()})]},e.id))})]})]}),(0,s.jsxs)("div",{className:"relative",ref:w,children:[(0,s.jsxs)("button",{onClick:()=>u(!h),className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-100",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:(0,s.jsx)(i.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{className:"hidden md:block text-left",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-800",children:(null==t?void 0:t.name)||"User"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:(null==t?void 0:t.role)||"Role"})]})]}),h&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[(0,s.jsxs)("div",{className:"p-3 border-b border-gray-200",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-800",children:null==t?void 0:t.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:null==t?void 0:t.email})]}),(0,s.jsxs)("button",{onClick:x,className:"w-full flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[(0,s.jsx)(o.A,{className:"w-4 h-4"}),"Logout"]})]})]})]})]})})}},85524:(e,r,t)=>{t.d(r,{A:()=>g});var s=t(95155),a=t(67396),l=t(76046),n=t(34696),i=t(30858),o=t(20591),c=t(57223),d=t(14081),m=t(63348),x=t(36972),h=t(92823),u=t(40767);function g(e){var r,t;let{isOpen:g,onClose:f}=e,b=(0,l.usePathname)(),{user:v}=(0,n.A)(),j=[{name:"Dashboard",href:"/dashboard",icon:i.A,roles:["admin","donor","volunteer","relief_worker"]},{name:"Donations",href:"/donations",icon:o.A,roles:["admin","donor","volunteer","relief_worker"]},{name:"Tracking",href:"/tracking",icon:c.A,roles:["admin","donor","volunteer","relief_worker"]},{name:"Reports",href:"/reports",icon:d.A,roles:["admin","relief_worker"]},{name:"Feedback",href:"/feedback",icon:m.A,roles:["admin","donor","volunteer","relief_worker"]},{name:"Calamities",href:"/calamities",icon:x.A,roles:["admin","relief_worker"]},{name:"Users",href:"/users",icon:h.A,roles:["admin"]},{name:"Volunteers",href:"/volunteers",icon:o.A,roles:["admin","donor","volunteer","relief_worker"]}].filter(e=>e.roles.includes(null==v?void 0:v.role)),p=e=>b===e;return(0,s.jsxs)(s.Fragment,{children:[g&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:f}),(0,s.jsx)("aside",{className:"fixed lg:sticky top-0 lg:top-0 left-0 z-40 w-64 h-screen lg:h-screen bg-gradient-to-b from-gray-50 to-white border-r border-gray-200 shadow-lg lg:shadow-none transform transition-transform duration-300 ease-in-out ".concat(g?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:(0,s.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-200 bg-white",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)(o.A,{className:"w-5 h-5 text-white"})}),(0,s.jsx)("h2",{className:"text-lg font-bold text-gray-800",children:"Relief Hub"})]}),(0,s.jsx)("button",{onClick:f,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,s.jsx)(u.A,{className:"w-5 h-5 text-gray-600"})})]})}),(0,s.jsx)("nav",{className:"flex-1 overflow-y-auto p-4 pt-6 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent",children:(0,s.jsx)("ul",{className:"space-y-1",children:j.map(e=>{let r=e.icon,t=p(e.href);return(0,s.jsx)("li",{children:(0,s.jsxs)(a.default,{href:e.href,onClick:f,className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 group ".concat(t?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-white hover:shadow-sm"),children:[(0,s.jsx)(r,{className:"w-5 h-5 transition-transform group-hover:scale-110 ".concat(t?"text-white":"text-gray-500")}),(0,s.jsx)("span",{className:"font-medium text-sm",children:e.name})]})},e.name)})})}),(0,s.jsx)("div",{className:"flex-shrink-0 p-4 border-t border-gray-200 bg-white",children:(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-full flex items-center justify-center shadow-md",children:(0,s.jsx)("span",{className:"text-white font-bold text-sm",children:null==v?void 0:null===(r=v.name)||void 0===r?void 0:r.charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-gray-800 truncate",children:null==v?void 0:v.name}),(0,s.jsx)("p",{className:"text-xs text-blue-600 capitalize font-medium",children:null==v?void 0:null===(t=v.role)||void 0===t?void 0:t.replace("_"," ")})]})]})})]})})]})}}}]);